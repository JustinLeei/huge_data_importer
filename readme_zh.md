# huge_data_importer
[英文版](readme.md)

这是一个用于将数据从CSV、XLSX或ZIP文件导入到MySQL数据库的Java项目。它提供了灵活的配置选项和可扩展的架构,使数据导入过程更加简单和高效。

## 功能特性

- 支持解析CSV、XLSX和ZIP格式的文件
- 可配置数据表和列名表的前缀以及是否创建新表
- 支持高达100万行以上的数据导入,占用内存小,速度快
- 可以方便地集成到其他Java项目中使用

## 项目结构

- `ImportConfig`: 存储导入配置的类，包括数据表前缀、列名表前缀、是否创建数据表和列名表等。
- `FileParser`: 文件解析器接口，定义了解析文件的方法。
- `CSVParser`: CSV文件解析器的实现类。
- `XLSXParser`: XLSX文件解析器的实现类。
- `CellUtil`: 工具类，用于处理和规范化单元格数据。
- `CSVReader`: 读取CSV文件的工具类。
- `XlsxReadListener`: XLSX文件读取监听器。
- `DatabaseImporter`: 数据库导入器接口。
- `DatabaseImporterImpl`: 数据库导入器的实现类。
- `DataWriter`: 数据写入器接口。
- `MysqlWriter`: MySQL数据写入器的实现类。
- `exception`: 包含各种自定义异常类。
- `config`: 包含配置类，如`TableConfig`和`ThreadExecuter`。

## 配置

项目使用Spring框架进行配置管理,通过`application.properties`或`application.yml`文件配置数据库连接。

## 使用方法

1. 克隆或下载项目到本地。
2. 配置`application.yaml`,指定原始**非数值列**映射前后的名称。数值列请查看**入库后的效果**
   ```yaml
   hdi:
     table:
       # 数字列名保留设置，设置为 false 时数字列名将转换为1, 2, 3...，实际列名存储在_colNameTable中
       keep-original-numeric-names: false

       # 时间列映射：原始列名 -> 转换后的列名
       time-column-mapping:
         "[入学时间]": 入学时间
         "[毕业时间]": 毕业时间
         "[出生日期]": 出生日期
         "[注册日期]": 注册日期
         "[最后登录时间]": 最后登录时间

       # 非时间列映射：原始列名 -> 转换后的列名
       non-time-column-mapping:
         "[学号]": 学生编号
         "[姓名]": 姓名
         "[性别]": 性别
         "[年龄]": 年龄
         "[专业名称]": 专业
         "[班级名称]": 班级
         "[联系电话]": 联系电话
         "[电子邮箱]": 电子邮箱
         "[家庭住址]": 家庭住址
         "[身份证号]": 身份证号
         "[紧急联系人]": 紧急联系人
         "[紧急联系人电话]": 紧急联系人电话
         "[学历层次]": 学历层次
         "[学籍状态]": 学籍状态
         "[奖学金等级]": 奖学金等级
         "[学分]": 累计学分
         "[课程名称]": 当前课程名称
         "[导师姓名]": 导师姓名
         "[宿舍号]": 宿舍号

   ```
4. 将需要导入的CSV、XLSX或ZIP文件放置在指定目录下。
5. 在项目中引入依赖,注入`DatabaseImporterImpl`对象:
   ```java
   @Autowired 
   DatabaseImporterImpl databaseImporter;
   ```
6. 调用`importToDatabase`方法执行数据导入:
   ```java
   databaseImporter.importToDatabase(filePaths, importConfig);
   ```
   其中`filePaths`是要导入的文件路径列表,`importConfig`是导入的相关配置。
7. 数据导入完成后,可以在配置的MySQL数据库中查看导入的数据。
## 入库后效果
```
/**
 * {para}_colNameTable的形式如下：
 *
 * id |originColName
 * ---+-------------------------------------
 *  1 |学生ID
 *  2 |学生姓名
 *  3 |学生年龄
 *  4 |入学年份
 *  5 |专业
 *  6 |学期GPA
 *  7 |出勤率(%)
 *  8 |学费缴纳状态
 *  9 |毕业状态
 * 10 |奖学金获得情况
 * -----------------------------------------
 */

/**
 * {para}_dataTable的示例：
 * 开始时间          |学生ID |学生姓名     |1   |2     |3 |4     |5   |6   |7   |8
 * ----------------+------+------------+----+------+---+------+----+----+----+---
 * 2024-04-29 12:00:00|1001 |张三        |1001|张三   |20 |2022  |计算机|3.5 |95.0|已缴
 * 2024-04-29 12:15:00|1002 |李四        |1002|李四   |21 |2021  |数学  |3.8 |90.0|已缴
 * ---------------------------------------------------------------------
 */

```
## 贡献
欢迎对本项目提出建议和贡献代码。如果您发现了任何问题或有改进的想法，请提交Issue或Pull Request。
## 许可证
本项目采用[MIT许可证](LICENSE)。
